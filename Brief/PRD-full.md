# Opennie - 智能记账应用 PRD (Product Requirements Document)

## 1. 产品概述

### 1.1 产品简介
Opennie 是一款智能记账应用，旨在为个人和家庭提供简单、智能、全面的财务管理解决方案。通过多样化的记账方式、智能数据分析和 AI 助手，帮助用户更好地管理个人财务。

### 1.2 产品定位
- **目标用户**：个人用户、小家庭、情侣、室友等需要财务管理的群体
- **核心价值**：简单记账 + 智能分析 + 多人协作
- **差异化**：AI 对话查询、多种记账方式、智能识别

### 1.3 产品目标
- 降低记账门槛，提高记账效率
- 提供清晰的财务洞察和预算管理
- 支持多人协作的支出管理
- 通过 AI 技术提升用户体验

## 2. 用户画像与使用场景

### 2.1 用户画像
**主要用户**：
- 年龄：22-40 岁
- 特征：有一定财务管理意识，希望了解自己的消费习惯
- 痛点：记账麻烦、数据分析复杂、多人支出难以统计

**使用场景**：
- 日常消费后快速记账
- 月末查看消费报表和预算执行情况
- 情侣/室友间的共同支出管理
- 通过语音/图片快速记录消费

## 3. 功能架构

### 3.1 核心功能模块
```
Opennie
├── 首页（记账页）
│   ├── 账本管理
│   ├── 预算总览
│   ├── 趋势数据
│   ├── 账单明细
│   └── 快捷记账
├── 资产管理
│   ├── 资产总览
│   ├── 负债管理
│   ├── 资产分布
│   └── 资产趋势
├── 报表统计
│   ├── 收支分析
│   ├── 分类统计
│   └── 趋势分析
├── AI 对话
│   ├── 自然语言查询
│   ├── 财务洞察
│   └── 智能建议
└── 设置中心
    ├── 账户管理
    ├── 分类设置
    ├── 数据同步
    └── 隐私设置
```

## 4. 详细功能需求

### 4.1 首页（记账页）

#### 4.1.1 时间周期选择
- **功能描述**：用户可选择查看不同时间段的数据
- **交互设计**：
  - 默认显示当月数据
  - 支持快速切换：今日、本周、本月、本年
  - 支持自定义时间范围选择
- **数据展示**：选择时间段后，页面所有数据相应更新

#### 4.1.2 账本管理
- **多账本支持**：
  - 个人账本：默认账本，个人使用
  - 共享账本：支持多人协作，实时同步
  - 项目账本：特定项目或活动的账本
- **账本切换**：
  - 顶部账本选择器，显示当前账本名称
  - 点击后展示账本列表，支持快速切换
  - 新建账本功能
- **数据展示**：
  - 当期收入总额
  - 当期支出总额
  - 当期结余（收入-支出）
  - 对比上期数据变化（百分比和绝对值）

#### 4.1.3 预算管理
- **预算总览卡片**：
  - 显示当期预算执行情况
  - 预算剩余金额和剩余天数
  - 预算执行进度条（颜色区分：绿色安全、黄色警告、红色超支）
- **预算详情页**：
  - 总预算设置和执行情况
  - 分类预算列表，显示各分类执行情况
  - 预算建议和优化提示
- **创建/编辑预算**：
  - 预算周期选择：月度、季度、年度
  - 总预算金额设置
  - 分类预算分配（支持拖拽调整比例）
  - 预算模板（参考历史数据生成）

#### 4.1.4 趋势数据
- **最近趋势图表**：
  - 近7天/30天收支趋势折线图
  - 支出分类占比饼图
  - 与历史同期对比
- **快速洞察**：
  - 本周/月最大支出项
  - 消费习惯变化提醒
  - 异常支出检测

#### 4.1.5 账单明细
- **按天聚合显示**：
  - 日期 + 当日总支出/收入
  - 展开显示当日所有账单
  - 支持上拉加载更多
- **账单实体属性**：
  - 金额（必填）
  - 币种（默认人民币，支持多币种）
  - 类型：收入/支出/转账
  - 分类（可自定义分类）
  - 账户（来源账户，如现金/银行卡/支付宝等）
  - 备注（可选）
  - 时间（精确到分钟）
  - 图片附件（可选）
- **操作功能**：
  - 左滑删除/编辑
  - 批量选择和操作
  - 搜索和筛选

#### 4.1.6 快捷记账入口
- **浮动按钮设计**：
  - 主页面右下角固定浮动按钮
  - 点击展开记账方式选项
- **记账方式**：
  - **手动输入**：
    - 快速输入界面，金额数字键盘
    - 智能分类推荐
    - 常用备注快捷选择
  - **图片识别**：
    - 拍照或选择相册图片
    - OCR 识别账单信息（商家、金额、时间）
    - 用户确认后保存
  - **语音输入**：
    - 语音转文字
    - NLP 解析金额、分类、备注等信息
    - 确认界面展示解析结果

### 4.2 额外记账方式

#### 4.2.1 截图识别
- **快捷指令集成**：
  - iOS 快捷指令：截图后自动识别并拉起 APP
  - Android Intent 支持
- **识别流程**：
  - 截图 → OCR 识别 → 信息提取 → 打开 APP 预填表单

#### 4.2.2 批量导入
- **支持格式**：
  - 支付宝账单 CSV
  - 微信支付账单 CSV
  - 银行流水 Excel/CSV
- **导入流程**：
  - 文件上传 → 格式识别 → 字段映射 → 预览确认 → 批量导入
- **数据处理**：
  - 自动分类匹配
  - 重复数据检测
  - 导入日志记录

### 4.3 资产管理页面

#### 4.3.1 资产总览
- **核心指标**：
  - 净资产 = 总资产 - 总负债
  - 总资产（所有账户余额 + 固定资产价值）
  - 总负债（借款、信用卡欠款等）
  - 负债率 = 总负债 / 总资产
- **资产变化趋势**：
  - 月度/年度净资产变化曲线
  - 资产组成变化对比

#### 4.3.2 负债管理
- **借入管理**：
  - 借款记录（金额、利率、期限、来源）
  - 还款计划和提醒
  - 利息计算
- **借出管理**：
  - 借出记录和回收情况
  - 逾期提醒
  - 借贷统计

#### 4.3.3 资产分布
- **桑基图展示**：
  - 资产类型流向（现金、投资、固定资产等）
  - 账户分布（银行卡、支付宝、现金等）
- **资产明细**：
  - 账户列表和余额
  - 资产价值变化记录

#### 4.3.4 资产管理
- **资产实体属性**：
  - 名称（如"招商银行储蓄卡"）
  - 类型：账户类型（现金/银行卡/信用卡/投资账户）或其他资产（房产/车辆/股票）
  - 余额/价值
  - 币种
  - 是否计入总资产（隐藏资产功能）
  - 备注
- **操作功能**：
  - 新增/编辑/删除资产
  - 资产价值更新记录
  - 资产转换（如现金转银行卡）

### 4.4 报表统计页面

#### 4.4.1 时间维度分析
- **时间区间选择**：
  - 预设选项：本月、上月、本季度、本年度
  - 自定义时间范围
  - 同比/环比分析
- **核心指标**：
  - 总收入、总支出、净收入
  - 平均日支出
  - 收支比例

#### 4.4.2 趋势分析
- **每日收支趋势**：
  - 收入/支出双轴折线图
  - 周末vs工作日对比
  - 异常值标注
- **月度对比**：
  - 月度收支柱状图
  - 趋势变化分析

#### 4.4.3 分类统计
- **支出分类分析**：
  - 饼图显示各分类占比
  - 分类排行榜
  - 分类趋势变化
- **分类明细**：
  - 点击分类查看明细账单
  - 分类预算对比
  - 分类消费建议

### 4.5 AI 对话功能

#### 4.5.1 自然语言查询
- **查询示例**：
  - "本周花了多少钱？"
  - "本月最大的支出是什么？"
  - "我的餐饮支出趋势如何？"
  - "帮我分析一下消费习惯"
- **技术实现**：
  - NL2SQL：自然语言转换为 SQL 查询
  - Dify 工作流集成
  - 后端数据查询和结果返回

#### 4.5.2 智能分析
- **财务洞察**：
  - 消费模式识别
  - 异常支出检测
  - 预算优化建议
- **个性化建议**：
  - 基于历史数据的消费建议
  - 储蓄目标规划
  - 投资建议（基础）

### 4.6 其他功能

#### 4.6.1 多币种支持
- **汇率管理**：
  - 实时汇率获取
  - 历史汇率查询
  - 人民币等值显示
- **币种转换**：
  - 记账时显示等值人民币
  - 报表统一币种显示

#### 4.6.2 周期记账
- **周期性支出**：
  - 房租、水电费等固定支出
  - 订阅服务（Netflix、会员费等）
  - 分期付款
- **自动记账**：
  - 预设周期规则
  - 自动生成账单
  - 提醒确认功能

#### 4.6.3 报销管理
- **报销单据**：
  - 发票图片管理
  - 报销分类和金额
  - 报销状态跟踪
- **报销流程**：
  - 提交报销申请
  - 审批状态查看
  - 到账确认

## 5. 用户交互设计

### 5.1 导航结构
- **底部导航**：首页、资产、报表、AI、我的
- **顶部导航**：账本切换、时间选择、搜索
- **侧边栏**：设置、帮助、反馈

### 5.2 界面设计原则
- **简洁性**：减少认知负担，突出核心功能
- **一致性**：统一的设计语言和交互模式
- **效率性**：快速记账，减少操作步骤
- **可达性**：支持无障碍访问

### 5.3 关键交互流程
- **快速记账流程**：点击浮动按钮 → 选择记账方式 → 输入信息 → 确认保存
- **预算设置流程**：预算入口 → 选择周期 → 设置总额 → 分配分类 → 保存
- **AI查询流程**：AI页面 → 语音/文字输入 → 查询处理 → 结果展示

## 6. 技术实现方案

### 6.1 技术架构
- **前端**：React Router + TypeScript + PWA
- **后端**：Node.js/Python + RESTful API
- **数据库**：PostgreSQL/SQLite
- **AI服务**：Dify 工作流 + OpenAI API
- **图像识别**：OCR API（腾讯云/百度云）
- **语音识别**：Web Speech API/讯飞语音

### 6.2 核心技术点
- **数据同步**：多端数据同步机制
- **离线支持**：Service Worker + 本地存储
- **安全性**：数据加密、用户认证
- **性能优化**：数据分页、图片压缩、缓存策略

### 6.3 第三方集成
- **支付宝/微信**：账单导入 API
- **银行接口**：银行卡余额查询（可选）
- **汇率服务**：实时汇率 API
- **云存储**：图片和数据备份

## 7. 数据模型设计

### 7.1 核心实体
```sql
-- 用户表
users (id, username, email, created_at, settings)

-- 账本表
books (id, user_id, name, type, shared_users, created_at)

-- 账户表
accounts (id, book_id, name, type, balance, currency, is_included)

-- 分类表
categories (id, book_id, name, type, parent_id, icon, color)

-- 账单表
transactions (id, book_id, account_id, category_id, amount, currency, type, description, date, images, created_at)

-- 预算表
budgets (id, book_id, period, total_amount, start_date, end_date)

-- 预算分类表
budget_categories (id, budget_id, category_id, amount)
```

### 7.2 数据关系
- 用户 1:N 账本
- 账本 1:N 账户/分类/账单/预算
- 账单 N:1 账户/分类
- 预算 1:N 预算分类

## 8. 开发计划

### 8.1 MVP 版本（v1.0）
**核心功能**：
- 基础记账（手动输入）
- 账单列表和分类
- 简单报表统计
- 资产管理基础功能

**开发周期**：4-6 周

### 8.2 增强版本（v2.0）
**新增功能**：
- 图片/语音识别记账
- 预算管理
- AI 对话查询
- 多人协作账本

**开发周期**：6-8 周

### 8.3 完整版本（v3.0）
**新增功能**：
- 批量导入
- 高级报表分析
- 周期记账
- 报销管理

**开发周期**：4-6 周

## 9. 成功指标

### 9.1 用户指标
- 日活跃用户数（DAU）
- 用户留存率（7日、30日）
- 用户记账频率
- 功能使用率

### 9.2 业务指标
- 记账数据准确性
- AI 查询成功率
- 用户满意度评分
- 应用商店评分

### 9.3 技术指标
- 应用启动时间 < 2s
- 图片识别准确率 > 85%
- 语音识别准确率 > 90%
- 应用崩溃率 < 0.1%

## 10. 风险评估

### 10.1 技术风险
- AI 识别准确性不足
- 多端数据同步复杂性
- 第三方服务依赖

### 10.2 产品风险
- 用户习惯培养困难
- 竞品功能同质化
- 隐私安全顾虑

### 10.3 应对策略
- 技术预研和 POC 验证
- 用户调研和产品迭代
- 隐私保护和安全认证

---

**文档版本**：v1.0
**最后更新**：2024年
**负责人**：产品团队
